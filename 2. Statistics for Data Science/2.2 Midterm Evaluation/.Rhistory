ylab = "Densidad",
xlim = rango_x,
ylim = rango_y,
col = "cadetblue",
lwd = 2)
lines(densidad_guerrero, col = "coral", lwd = 2)
densidad_colima <- density(colima_edad, na.rm = TRUE)
densidad_guerrero <- density(guerrero_edad, na.rm = TRUE)
densidad_jalisco <- density(jalisco_edad, na.rm = TRUE)
densidad_michoacan <- density(michoacan_edad, na.rm = TRUE)
densidad_nayarit <- density(nayarit_edad, na.rm = TRUE)
rango_x <- range(c(densidad_colima$x,
densidad_guerrero$x,
densidad_jalisco$x,
densidad_michoacan$x,
densidad_nayarit$x))
rango_y <- range(c(densidad_colima$y,
densidad_guerrero$y,
densidad_jalisco$y,
densidad_michoacan$y,
densidad_nayarit$y))
plot(densidad_colima, main = "Gráfico de Densidad de la Edad de Pacientes por Estado",
xlab = "Edad",
ylab = "Densidad",
xlim = rango_x,
ylim = rango_y,
col = "cadetblue",
lwd = 2)
lines(densidad_guerrero, col = "coral", lwd = 2)
densidad_colima
densidad_guerrero
densidad_jalisco
densidad_michoacan
densidad_nayarit
colima_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "COLIMA", ]$EDAD_ANOS
colima_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "COLIMA", ]$EDAD_ANOS
guerrero_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "GUERRERO", ]$EDAD_ANOS
jalisco_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "JALISCO", ]$EDAD_ANOS
michoacan_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "MICHOACÁN DE OCAMPO", ]$EDAD_ANOS
nayarit_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "NAYARIT", ]$EDAD_ANOS
densidad_colima <- density(colima_edad, na.rm = TRUE)
densidad_guerrero <- density(guerrero_edad, na.rm = TRUE)
densidad_jalisco <- density(jalisco_edad, na.rm = TRUE)
densidad_michoacan <- density(michoacan_edad, na.rm = TRUE)
densidad_nayarit <- density(nayarit_edad, na.rm = TRUE)
rango_x <- range(c(densidad_colima$x,
densidad_guerrero$x,
densidad_jalisco$x,
densidad_michoacan$x,
densidad_nayarit$x))
rango_y <- range(c(densidad_colima$y,
densidad_guerrero$y,
densidad_jalisco$y,
densidad_michoacan$y,
densidad_nayarit$y))
plot(densidad_colima, main = "Gráfico de Densidad de la Edad de Pacientes por Estado",
xlab = "Edad",
ylab = "Densidad",
xlim = rango_x,
ylim = rango_y,
col = "cadetblue",
lwd = 2)
lines(densidad_guerrero, col = "coral", lwd = 2)
dev.off()
dev.list()
colima_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "COLIMA", ]$EDAD_ANOS
guerrero_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "GUERRERO", ]$EDAD_ANOS
jalisco_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "JALISCO", ]$EDAD_ANOS
michoacan_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "MICHOACÁN DE OCAMPO", ]$EDAD_ANOS
nayarit_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "NAYARIT", ]$EDAD_ANOS
densidad_colima <- density(colima_edad, na.rm = TRUE)
densidad_guerrero <- density(guerrero_edad, na.rm = TRUE)
densidad_jalisco <- density(jalisco_edad, na.rm = TRUE)
densidad_michoacan <- density(michoacan_edad, na.rm = TRUE)
densidad_nayarit <- density(nayarit_edad, na.rm = TRUE)
rango_x <- range(c(densidad_colima$x,
densidad_guerrero$x,
densidad_jalisco$x,
densidad_michoacan$x,
densidad_nayarit$x))
rango_y <- range(c(densidad_colima$y,
densidad_guerrero$y,
densidad_jalisco$y,
densidad_michoacan$y,
densidad_nayarit$y))
plot(densidad_colima, main = "Gráfico de Densidad de la Edad de Pacientes por Estado",
xlab = "Edad",
ylab = "Densidad",
xlim = rango_x,
ylim = rango_y,
col = "cadetblue",
lwd = 2)
lines(densidad_guerrero, col = "coral", lwd = 2)
lines(densidad_jalisco, col = "antiquewhite4", lwd = 2)
lines(densidad_michoacan, col = "brown", lwd = 2)
lines(densidad_nayarit, col = "goldenrod", lwd = 2)
# Añadir una leyenda para identificar las curvas
legend("topright",
legend = c("COLIMA", "GUERRERO", "JALISCO", "MICHOACÁN DE OCAMPO", "NAYARIT"),
col = c("cadetblue", "coral", "antiquewhite4", "brown", "goldenrod"),
lty = 1, lwd = 2, cex = 0.8)
par(mar = c(10, 4, 3, 2) + 0.1)
boxplot(EDAD_ANOS ~ DESCRIPCIÓN_CATALOGO_SEXO * ENTIDAD_FEDERATIVA,
data = dengue_datos_estudio,
main = "Distribución de la edad por sexo y estado",
xlab = "",
ylab = "Edad (años)",
col = rep(c("lightblue", "pink"), 5),
las = 2,
cex.axis = 0.8)
par(mar = c(5, 4, 4, 2) + 0.1)
colima_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "COLIMA", ]$EDAD_ANOS
guerrero_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "GUERRERO", ]$EDAD_ANOS
jalisco_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "JALISCO", ]$EDAD_ANOS
michoacan_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "MICHOACÁN DE OCAMPO", ]$EDAD_ANOS
nayarit_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "NAYARIT", ]$EDAD_ANOS
densidad_colima <- density(colima_edad, na.rm = TRUE)
densidad_guerrero <- density(guerrero_edad, na.rm = TRUE)
densidad_jalisco <- density(jalisco_edad, na.rm = TRUE)
densidad_michoacan <- density(michoacan_edad, na.rm = TRUE)
densidad_nayarit <- density(nayarit_edad, na.rm = TRUE)
rango_x <- range(c(densidad_colima$x,
densidad_guerrero$x,
densidad_jalisco$x,
densidad_michoacan$x,
densidad_nayarit$x))
rango_y <- range(c(densidad_colima$y,
densidad_guerrero$y,
densidad_jalisco$y,
densidad_michoacan$y,
densidad_nayarit$y))
plot(densidad_colima, main = "Gráfico de Densidad de la Edad de Pacientes por Estado",
xlab = "Edad",
ylab = "Densidad",
xlim = rango_x,
ylim = rango_y,
col = "cadetblue",
lwd = 2)
lines(densidad_guerrero, col = "coral", lwd = 2)
top_municipio <- function(datos, codigo_estado) {
# Filtrar por el estado
datos_estado <- datos[datos$ENTIDAD_RES == codigo_estado, ]
# Contar la frecuencia de los municipios
conteo_municipios <- table(datos_estado$MUNICIPIO_RES)
# Encontrar el municipio con el máximo conteo
top_mun_code <- names(conteo_municipios)[which.max(conteo_municipios)]
return(top_mun_code)
}
colima_top_municipio <- top_municipio(dengue_datos_estudio, 6)
guerrero_top_municipio <- top_municipio(dengue_datos_estudio, 12)
jalisco_top_municipio <- top_municipio(dengue_datos_estudio, 14)
michoacan_top_municipio <- top_municipio(dengue_datos_estudio, 16)
nayarit_top_municipio <- top_municipio(dengue_datos_estudio, 18)
datos_top_municipios <- data.frame(
ENTIDAD_RES = c(6, 12, 14, 16, 18),
MUNICIPIO_RES = c(colima_top_municipio,
guerrero_top_municipio,
jalisco_top_municipio,
michoacan_top_municipio,
nayarit_top_municipio)
)
datos_top_municipios$MUNICIPIO_RES <- as.numeric(datos_top_municipios$MUNICIPIO_RES)
catalogo_municipio$CLAVE_MUNICIPIO <- as.numeric(catalogo_municipio$CLAVE_MUNICIPIO)
catalogo_municipio$CLAVE_ENTIDAD <- as.numeric(catalogo_municipio$CLAVE_ENTIDAD)
top_municipios_nombres <- merge(datos_top_municipios, catalogo_municipio,
by.x = c("ENTIDAD_RES", "MUNICIPIO_RES"),
by.y = c("CLAVE_ENTIDAD", "CLAVE_MUNICIPIO"),
all.x = TRUE)
top_municipios_nombres <- merge(top_municipios_nombres, catalogo_entidad, by.x = "ENTIDAD_RES", by.y = "CLAVE_ENTIDAD")
top_municipios_nombres$MUNICIPIO_ESTADO <- paste(top_municipios_nombres$MUNICIPIO, " (", top_municipios_nombres$ENTIDAD_FEDERATIVA, ")", sep="")
mun1 <- dengue_datos_estudio$ENTIDAD_RES == 6 & dengue_datos_estudio$MUNICIPIO_RES == colima_top_municipio
mun2 <- dengue_datos_estudio$ENTIDAD_RES == 12 & dengue_datos_estudio$MUNICIPIO_RES == guerrero_top_municipio
mun3 <- dengue_datos_estudio$ENTIDAD_RES == 14 & dengue_datos_estudio$MUNICIPIO_RES == jalisco_top_municipio
mun4 <- dengue_datos_estudio$ENTIDAD_RES == 16 & dengue_datos_estudio$MUNICIPIO_RES == michoacan_top_municipio
mun5 <- dengue_datos_estudio$ENTIDAD_RES == 18 & dengue_datos_estudio$MUNICIPIO_RES == nayarit_top_municipio
datos_top_mun <- dengue_datos_estudio[mun1 | mun2 | mun3 | mun4 | mun5, ]
datos_top_mun$ID_COMPUESTO <- paste(datos_top_mun$ENTIDAD_RES, datos_top_mun$MUNICIPIO_RES, sep = "_")
top_mun_vista <- top_municipios_nombres[, c("ENTIDAD_RES", "MUNICIPIO_RES", "MUNICIPIO_ESTADO")]
top_mun_vista$ID_COMPUESTO <- paste(top_mun_vista$ENTIDAD_RES, top_mun_vista$MUNICIPIO_RES, sep = "_")
datos_top_mun_final <- merge(datos_top_mun, top_mun_vista[, c("ID_COMPUESTO", "MUNICIPIO_ESTADO")],
by = "ID_COMPUESTO", all.x = TRUE)
muni_list <- unique(datos_top_mun_final$MUNICIPIO_ESTADO)
densidades_muni <- list()
colores <- c("cadetblue", "coral", "antiquewhite4", "brown", "goldenrod")
max_y <- 0
colima_mun_edad <- datos_top_mun_final[datos_top_mun_final$ENTIDAD_FEDERATIVA == "COLIMA", ]$EDAD_ANOS
densidad_colima_mun <- density(colima_mun_edad, na.rm = TRUE)
max_y <- max(max_y, max(densidad_colima_mun$y))
guerrero_mun_edad <- datos_top_mun_final[datos_top_mun_final$ENTIDAD_FEDERATIVA == "GUERRERO", ]$EDAD_ANOS
densidad_guerrero_mun <- density(guerrero_mun_edad, na.rm = TRUE)
max_y <- max(max_y, max(densidad_guerrero_mun$y))
jalisco_mun_edad <- datos_top_mun_final[datos_top_mun_final$ENTIDAD_FEDERATIVA == "JALISCO", ]$EDAD_ANOS
densidad_jalisco_mun <- density(jalisco_mun_edad, na.rm = TRUE)
max_y <- max(max_y, max(densidad_jalisco_mun$y))
michoacan_mun_edad <- datos_top_mun_final[datos_top_mun_final$ENTIDAD_FEDERATIVA == "MICHOACÁN DE OCAMPO", ]$EDAD_ANOS
densidad_michoacan_mun <- density(michoacan_mun_edad, na.rm = TRUE)
max_y <- max(max_y, max(densidad_michoacan_mun$y))
nayarit_mun_edad <- datos_top_mun_final[datos_top_mun_final$ENTIDAD_FEDERATIVA == "NAYARIT", ]$EDAD_ANOS
densidad_nayarit_mun<- density(nayarit_mun_edad, na.rm = TRUE)
max_y <- max(max_y, max(densidad_nayarit_mun$y))
plot(densidad_colima_mun,
main = "Densidad de la Edad de Pacientes en los municipios con más casos",
xlab = "Edad (años)",
ylab = "Densidad",
xlim = c(0, 100),
ylim = c(0, max_y * 1.05),
col = "cadetblue",
lwd = 2)
lines(guerrero_mun_edad, col = "coral", lwd = 2)
lines(densidad_jalisco_mun, col = "antiquewhite4", lwd = 2)
lines(densidad_michoacan_mun, col = "brown", lwd = 2)
lines(densidad_nayarit_mun, col = "goldenrod", lwd = 2)
# Añadir una leyenda
legend("topright",
legend = c("MANZANILLO (COLIMA)", "ACAPULCO DE JUÁREZ (GUERRERO)", "PUERTO VALLARTA (JALISCO)", "HUETAMO (MICHOACÁN)", "TEPIC (NAYARIT)"),
col = colores,
lty = 1, lwd = 2, cex = 0.7)
datos_top_mun_final
datos_top_mun
top_mun_vista
datos_top_mun
top_mun_vista <- top_municipios_nombres[, c("ENTIDAD_RES", "MUNICIPIO_RES", "MUNICIPIO_ESTADO")]
top_mun_vista
dengue_datos_base <- read.csv("dengue_abierto.csv")
catalogo_sexo <- read_excel("Catálogos_Dengue.xlsx", sheet = "CATÁLOGO SEXO")
catalogo_entidad <- read_excel("Catálogos_Dengue.xlsx", sheet = "CATÁLOGO ENTIDAD")
catalogo_municipio <- read_excel("Catálogos_Dengue.xlsx", sheet = "CATÁLOGO MUNICIPIO")
names(catalogo_sexo) <- c("CLAVE_SEXO", "DESCRIPCIÓN_CATALOGO_SEXO")
catalogo_entidad$CLAVE_ENTIDAD <- as.numeric(catalogo_entidad$CLAVE_ENTIDAD)
estados_estudio <- c(16, 6, 18, 14, 12)
dengue_datos_estudio <- dengue_datos_base[dengue_datos_base$ENTIDAD_RES %in% estados_estudio, ]
dengue_datos_estudio # 226425
dengue_datos_estudio <- merge(dengue_datos_estudio, catalogo_sexo,
by.x = "SEXO", by.y = "CLAVE_SEXO")
dengue_datos_estudio <- merge(dengue_datos_estudio, catalogo_entidad,
by.x = "ENTIDAD_RES", by.y = "CLAVE_ENTIDAD")
# 1. Edad Promedio y Desviación Estándar por Estado y Sexo
edad_promedio <- aggregate(EDAD_ANOS ~ ENTIDAD_FEDERATIVA + DESCRIPCIÓN_CATALOGO_SEXO,
data = dengue_datos_estudio,
FUN = mean,
na.rm = TRUE)
desviacion_estandar <- aggregate(EDAD_ANOS ~ ENTIDAD_FEDERATIVA + DESCRIPCIÓN_CATALOGO_SEXO,
data = dengue_datos_estudio,
FUN = sd,
na.rm = TRUE)
print(desviacion_estandar)
names(edad_promedio)[names(edad_promedio) == "EDAD_ANOS"] <- "EDAD_PROMEDIO"
print(edad_promedio)
names(desviacion_estandar)[names(desviacion_estandar) == "EDAD_ANOS"] <- "DESVIACION_ESTANDAR"
print(desviacion_estandar)
tabla_resumen_edad <- merge(edad_promedio, desviacion_estandar,
by = c("ENTIDAD_FEDERATIVA", "DESCRIPCIÓN_CATALOGO_SEXO"))
print(tabla_resumen_edad)
par(mar= c(10, 4, 3, 2))
boxplot(EDAD_ANOS ~ DESCRIPCIÓN_CATALOGO_SEXO * ENTIDAD_FEDERATIVA,
data = dengue_datos_estudio,
main = "Distribución de la edad por sexo y estado",
xlab = "",
ylab = "Edad (años)",
col = rep(c("lightblue", "pink"), 5),
las = 2)
# Separar los datos por estado
colima_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "COLIMA", ]$EDAD_ANOS
guerrero_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "GUERRERO", ]$EDAD_ANOS
jalisco_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "JALISCO", ]$EDAD_ANOS
michoacan_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "MICHOACÁN DE OCAMPO", ]$EDAD_ANOS
nayarit_edad <- dengue_datos_estudio[dengue_datos_estudio$ENTIDAD_FEDERATIVA == "NAYARIT", ]$EDAD_ANOS
# Calcular las densidades
densidad_colima <- density(colima_edad, na.rm = TRUE)
densidad_guerrero <- density(guerrero_edad, na.rm = TRUE)
densidad_jalisco <- density(jalisco_edad, na.rm = TRUE)
densidad_michoacan <- density(michoacan_edad, na.rm = TRUE)
densidad_nayarit <- density(nayarit_edad, na.rm = TRUE)
# Definir el rango de los ejes para que todas las curvas quepan
rango_x <- range(c(densidad_colima$x, densidad_guerrero$x, densidad_jalisco$x, densidad_michoacan$x, densidad_nayarit$x))
rango_y <- range(c(densidad_colima$y, densidad_guerrero$y, densidad_jalisco$y, densidad_michoacan$y, densidad_nayarit$y))
# Trazar el primer gráfico (COLIMA) con 'plot'
plot(densidad_colima,
main = "Gráfico de Densidad de la Edad de Pacientes por Estado",
xlab = "Edad (años)",
ylab = "Densidad",
xlim = rango_x,
ylim = rango_y,
col = "cadetblue",
lwd = 2)
# Añadir los gráficos de densidad restantes con 'lines'
lines(densidad_guerrero, col = "coral", lwd = 2)
lines(densidad_jalisco, col = "antiquewhite4", lwd = 2)
lines(densidad_michoacan, col = "brown", lwd = 2)
lines(densidad_nayarit, col = "goldenrod", lwd = 2)
# Añadir una leyenda para identificar las curvas
legend("topright",
legend = c("COLIMA", "GUERRERO", "JALISCO", "MICHOACÁN DE OCAMPO", "NAYARIT"),
col = c("cadetblue", "coral", "antiquewhite4", "brown", "goldenrod"),
lty = 1, lwd = 2, cex = 0.8)
# Restaurar el margen
par(mar = c(5, 4, 4, 2) + 0.1)
# 4. Gráfico de Densidad de los Municipios con Mayor Cantidad de Casos
top_municipio <- function(datos, codigo_estado) {
# Filtrar por el estado
datos_estado <- datos[datos$ENTIDAD_RES == codigo_estado, ]
# Contar la frecuencia de los municipios
conteo_municipios <- table(datos_estado$MUNICIPIO_RES)
# Encontrar el municipio con el máximo conteo
top_mun_code <- names(conteo_municipios)[which.max(conteo_municipios)]
return(top_mun_code)
}
colima_top_municipio <- top_municipio(dengue_datos_estudio, 6)
guerrero_top_municipio <- top_municipio(dengue_datos_estudio, 12)
jalisco_top_municipio <- top_municipio(dengue_datos_estudio, 14)
michoacan_top_municipio <- top_municipio(dengue_datos_estudio, 16)
nayarit_top_municipio <- top_municipio(dengue_datos_estudio, 18)
datos_top_municipios <- data.frame(
ENTIDAD_RES = c(6, 12, 14, 16, 18),
MUNICIPIO_RES = c(colima_top_municipio,
guerrero_top_municipio,
jalisco_top_municipio,
michoacan_top_municipio,
nayarit_top_municipio)
)
datos_top_municipios$MUNICIPIO_RES <- as.numeric(datos_top_municipios$MUNICIPIO_RES)
catalogo_municipio$CLAVE_MUNICIPIO <- as.numeric(catalogo_municipio$CLAVE_MUNICIPIO)
catalogo_municipio$CLAVE_ENTIDAD <- as.numeric(catalogo_municipio$CLAVE_ENTIDAD)
top_municipios_nombres <- merge(datos_top_municipios, catalogo_municipio,
by.x = c("ENTIDAD_RES", "MUNICIPIO_RES"),
by.y = c("CLAVE_ENTIDAD", "CLAVE_MUNICIPIO"),
all.x = TRUE)
top_municipios_nombres <- merge(top_municipios_nombres, catalogo_entidad, by.x = "ENTIDAD_RES", by.y = "CLAVE_ENTIDAD")
top_municipios_nombres$MUNICIPIO_ESTADO <- paste(top_municipios_nombres$MUNICIPIO, " (", top_municipios_nombres$ENTIDAD_FEDERATIVA, ")", sep="")
mun1 <- dengue_datos_estudio$ENTIDAD_RES == 6 & dengue_datos_estudio$MUNICIPIO_RES == colima_top_municipio
mun2 <- dengue_datos_estudio$ENTIDAD_RES == 12 & dengue_datos_estudio$MUNICIPIO_RES == guerrero_top_municipio
mun3 <- dengue_datos_estudio$ENTIDAD_RES == 14 & dengue_datos_estudio$MUNICIPIO_RES == jalisco_top_municipio
mun4 <- dengue_datos_estudio$ENTIDAD_RES == 16 & dengue_datos_estudio$MUNICIPIO_RES == michoacan_top_municipio
mun5 <- dengue_datos_estudio$ENTIDAD_RES == 18 & dengue_datos_estudio$MUNICIPIO_RES == nayarit_top_municipio
datos_top_mun <- dengue_datos_estudio[mun1 | mun2 | mun3 | mun4 | mun5, ]
datos_top_mun$ID_COMPUESTO <- paste(datos_top_mun$ENTIDAD_RES, datos_top_mun$MUNICIPIO_RES, sep = "_")
top_mun_vista <- top_municipios_nombres[, c("ENTIDAD_RES", "MUNICIPIO_RES", "MUNICIPIO_ESTADO")]
top_mun_vista$ID_COMPUESTO <- paste(top_mun_vista$ENTIDAD_RES, top_mun_vista$MUNICIPIO_RES, sep = "_")
datos_top_mun_final <- merge(datos_top_mun, top_mun_vista[, c("ID_COMPUESTO", "MUNICIPIO_ESTADO")],
by = "ID_COMPUESTO", all.x = TRUE)
muni_list <- unique(datos_top_mun_final$MUNICIPIO_ESTADO)
densidades_muni <- list()
colores <- c("cadetblue", "coral", "antiquewhite4", "brown", "goldenrod")
max_y <- 0
# 1. COLIMA
colima_mun_edad <- datos_top_mun_final[datos_top_mun_final$ENTIDAD_FEDERATIVA == "COLIMA", ]$EDAD_ANOS
densidad_colima_mun <- density(colima_mun_edad, na.rm = TRUE)
max_y <- max(max_y, max(densidad_colima_mun$y))
# 2. GUERRERO
guerrero_mun_edad <- datos_top_mun_final[datos_top_mun_final$ENTIDAD_FEDERATIVA == "GUERRERO", ]$EDAD_ANOS
densidad_guerrero_mun <- density(guerrero_mun_edad, na.rm = TRUE)
max_y <- max(max_y, max(densidad_guerrero_mun$y))
# 3. JALISCO
jalisco_mun_edad <- datos_top_mun_final[datos_top_mun_final$ENTIDAD_FEDERATIVA == "JALISCO", ]$EDAD_ANOS
densidad_jalisco_mun <- density(jalisco_mun_edad, na.rm = TRUE)
max_y <- max(max_y, max(densidad_jalisco_mun$y))
# 4. MICHOACÁN
michoacan_mun_edad <- datos_top_mun_final[datos_top_mun_final$ENTIDAD_FEDERATIVA == "MICHOACÁN DE OCAMPO", ]$EDAD_ANOS
densidad_michoacan_mun <- density(michoacan_mun_edad, na.rm = TRUE)
max_y <- max(max_y, max(densidad_michoacan_mun$y))
# 5. NAYARIT
nayarit_mun_edad <- datos_top_mun_final[datos_top_mun_final$ENTIDAD_FEDERATIVA == "NAYARIT", ]$EDAD_ANOS
densidad_nayarit_mun<- density(nayarit_mun_edad, na.rm = TRUE)
max_y <- max(max_y, max(densidad_nayarit_mun$y))
plot(densidad_colima_mun,
main = "Densidad de la Edad de Pacientes en los municipios con más casos",
xlab = "Edad (años)",
ylab = "Densidad",
xlim = c(0, 100),
ylim = c(0, max_y * 1.05),
col = "cadetblue",
lwd = 2)
lines(guerrero_mun_edad, col = "coral", lwd = 2)
lines(densidad_jalisco_mun, col = "antiquewhite4", lwd = 2)
lines(densidad_michoacan_mun, col = "brown", lwd = 2)
lines(densidad_nayarit_mun, col = "goldenrod", lwd = 2)
# Añadir una leyenda
legend("topright",
legend = c("MANZANILLO (COLIMA)", "ACAPULCO DE JUÁREZ (GUERRERO)", "PUERTO VALLARTA (JALISCO)", "HUETAMO (MICHOACÁN)", "TEPIC (NAYARIT)"),
col = colores,
lty = 1, lwd = 2, cex = 0.7)
guerrero_mun_edad
densidad_guerrero_mun
densidad_colima_mun
plot(densidad_colima_mun,
main = "Densidad de la Edad de Pacientes en los municipios con más casos",
xlab = "Edad (años)",
ylab = "Densidad",
xlim = c(0, 100),
ylim = c(0, max_y * 1.05),
col = "cadetblue",
lwd = 2)
lines(guerrero_mun_edad, col = "coral", lwd = 2)
max_y
max_y
max_y
max_y
max_y
max_y
max_y <- 0
max_y
max_y <- max(max_y, max(densidad_colima_mun$y))
max_y
plot(densidad_colima_mun,
main = "Densidad de la Edad de Pacientes en los municipios con más casos",
xlab = "Edad (años)",
ylab = "Densidad",
xlim = c(0, 100),
ylim = c(0, 0.05 * 1.05),
col = "cadetblue",
lwd = 2)
lines(guerrero_mun_edad, col = "coral", lwd = 2)
lines(densidad_jalisco_mun, col = "antiquewhite4", lwd = 2)
lines(densidad_michoacan_mun, col = "brown", lwd = 2)
lines(densidad_nayarit_mun, col = "goldenrod", lwd = 2)
# Añadir una leyenda
legend("topright",
legend = c("MANZANILLO (COLIMA)", "ACAPULCO DE JUÁREZ (GUERRERO)", "PUERTO VALLARTA (JALISCO)", "HUETAMO (MICHOACÁN)", "TEPIC (NAYARIT)"),
col = colores,
lty = 1, lwd = 2, cex = 0.7)
desviacion_estandar <- aggregate(EDAD_ANOS ~ ENTIDAD_FEDERATIVA + DESCRIPCIÓN_CATALOGO_SEXO,
data = dengue_datos_estudio,
FUN = sd,
na.rm = TRUE)
print(desviacion_estandar)
densidad_colima_mun
plot(densidad_colima_mun,
main = "Densidad de la edad de Pacientes en los municipios con más casos",
xlab = "Edad (años)",
ylab = "Densidad",
xlim = c(0, 100),
ylim = c(0, max_y * 1.05),
col = "cadetblue",
lwd = 2)
#lines(guerrero_mun_edad, col = "coral", lwd = 2)
lines(densidad_jalisco_mun, col = "antiquewhite4", lwd = 2)
lines(densidad_michoacan_mun, col = "brown", lwd = 2)
lines(densidad_nayarit_mun, col = "goldenrod", lwd = 2)
# Añadir una leyenda
legend("topright",
legend = c("MANZANILLO (COLIMA)", "ACAPULCO DE JUÁREZ (GUERRERO)", "PUERTO VALLARTA (JALISCO)", "HUETAMO (MICHOACÁN)", "TEPIC (NAYARIT)"),
col = colores,
lty = 1, lwd = 2, cex = 0.7)
& dengue_datos_estudio$MUNICIPIO_RES == colima_top_municipio
dengue_datos_estudio$FECHA <- dmy(dengue_datos_estudio$FECHA_SIGN_SINTOMAS)
dengue_datos_estudio$MES_NUMERO <- month(dengue_datos_estudio$FECHA)
dengue_datos_estudio$MES_NOMBRE <- month(dengue_datos_estudio$FECHA, label = TRUE, abbr = FALSE, locale = "es_ES.UTF-8")
datos_meses <- dengue_datos_estudio[dengue_datos_estudio$MES_NUMERO >= 1 & dengue_datos_estudio$MES_NUMERO <= 9, ]
frecuencia_mensual <- table(datos_meses$ENTIDAD_FEDERATIVA, datos_meses$MES_NOMBRE)
par(mfrow = c(2, 3), mar = c(4, 4, 3, 1))
colores_estado <- c("cadetblue", "coral", "antiquewhite4", "brown", "goldenrod")
orden_meses <- c("enero", "febrero", "marzo", "abril", "mayo", "junio", "julio", "agosto", "septiembre")
frecuencia_mensual <- frecuencia_mensual[, orden_meses]
estados_ordenados <- rownames(frecuencia_mensual)
colima_freq <- frecuencia_mensual["COLIMA", ]
barplot(colima_freq, main = estados_ordenados[1], col = colores_estado[1],
ylab = "Frecuencia", xlab = "Mes", las = 2, cex.names = 0.7)
guerrero_freq <- frecuencia_mensual["GUERRERO", ]
barplot(guerrero_freq, main = estados_ordenados[2], col = colores_estado[2],
ylab = "Frecuencia", xlab = "Mes", las = 2, cex.names = 0.7)
jalisco_freq <- frecuencia_mensual["JALISCO", ]
barplot(jalisco_freq, main = estados_ordenados[3], col = colores_estado[3],
ylab = "Frecuencia", xlab = "Mes", las = 2, cex.names = 0.7)
michoacan_freq <- frecuencia_mensual["MICHOACÁN DE OCAMPO", ]
barplot(michoacan_freq, main = estados_ordenados[4], col = colores_estado[4],
ylab = "Frecuencia", xlab = "Mes", las = 2, cex.names = 0.7)
nayarit_freq <- frecuencia_mensual["NAYARIT", ]
barplot(nayarit_freq, main = estados_ordenados[5], col = colores_estado[5],
ylab = "Frecuencia", xlab = "Mes", las = 2, cex.names = 0.7)
dengue_datos_estudio$FECHA <- dmy(dengue_datos_estudio$FECHA_SIGN_SINTOMAS)
dengue_datos_estudio$MES_NUMERO <- month(dengue_datos_estudio$FECHA)
dengue_datos_estudio$MES_NOMBRE <- month(dengue_datos_estudio$FECHA, label = TRUE, abbr = FALSE, locale = "es_ES.UTF-8")
datos_meses <- dengue_datos_estudio[dengue_datos_estudio$MES_NUMERO >= 1 & dengue_datos_estudio$MES_NUMERO <= 9, ]
frecuencia_mensual <- table(datos_meses$ENTIDAD_FEDERATIVA, datos_meses$MES_NOMBRE)
#par(mfrow = c(2, 3), mar = c(4, 4, 3, 1))
colores_estado <- c("cadetblue", "coral", "antiquewhite4", "brown", "goldenrod")
orden_meses <- c("enero", "febrero", "marzo", "abril", "mayo", "junio", "julio", "agosto", "septiembre")
frecuencia_mensual <- frecuencia_mensual[, orden_meses]
estados_ordenados <- rownames(frecuencia_mensual)
colima_freq <- frecuencia_mensual["COLIMA", ]
barplot(colima_freq, main = estados_ordenados[1], col = colores_estado[1],
ylab = "Frecuencia", xlab = "Mes", las = 2, cex.names = 0.7)
# GUERRERO
guerrero_freq <- frecuencia_mensual["GUERRERO", ]
barplot(guerrero_freq, main = estados_ordenados[2], col = colores_estado[2],
ylab = "Frecuencia", xlab = "Mes", las = 2, cex.names = 0.7)
# JALISCO
jalisco_freq <- frecuencia_mensual["JALISCO", ]
barplot(jalisco_freq, main = estados_ordenados[3], col = colores_estado[3],
ylab = "Frecuencia", xlab = "Mes", las = 2, cex.names = 0.7)
# MICHOACÁN DE OCAMPO
michoacan_freq <- frecuencia_mensual["MICHOACÁN DE OCAMPO", ]
barplot(michoacan_freq, main = estados_ordenados[4], col = colores_estado[4],
ylab = "Frecuencia", xlab = "Mes", las = 2, cex.names = 0.7)
# NAYARIT
nayarit_freq <- frecuencia_mensual["NAYARIT", ]
barplot(nayarit_freq, main = estados_ordenados[5], col = colores_estado[5],
ylab = "Frecuencia", xlab = "Mes", las = 2, cex.names = 0.7)
barplot(guerrero_freq, main = estados_ordenados[2], col = colores_estado[2],
ylab = "Frecuencia", xlab = "Mes", las = 2, cex.names = 0.7)
knitr::opts_chunk$set(echo = TRUE)
plot(densidad_colima, main = "Gráfico de densidad de edad de casos por estado",
xlab = "Edad",
ylab = "Densidad",
xlim = rango_x,
ylim = rango_y,
col = "cadetblue",
lwd = 2)
plot.new
lines(densidad_guerrero, col = "coral", lwd = 2)
plot.new()
lines(densidad_guerrero, col = "coral", lwd = 2)
